!function(){"use strict";angular.module("musApp",["ngRoute","ngDialog","btford.socket-io"])}(),function(){"use strict";angular.module("musApp").controller("chatController",["$scope","$element","$filter","musSocketService",function(e,o,t,r){e.chatLog="",e.message="",e.$on("socket:room-join-success",function(o,t){e.updateLog("Room","Welcome to the room "+t+"!")}),e.$on("socket:new-message",function(o,t){e.updateLog(JSON.parse(t).playerName,JSON.parse(t).message)}),e.$on("socket:new-player-joined",function(o,t){e.updateLog("Room",t+" has joined the room")}),e.$on("socket:player-left",function(o,t){e.updateLog("Room",t+" has left the room")}),e.$watch("chatLog",function(){var e=o[0].children[0];e.scrollTop=e.scrollHeight}),e.updateLog=function(o,r){e.chatLog+=t("formatMessage")(o,r)},e.sendMessage=function(){r.emit("message",e.message),e.message=""}}])}(),function(){"use strict";angular.module("musApp").controller("mainCtrl",["$scope","$location","ngDialog","musSocketService",function(e,o,t,r){e.musModel={},e.playerName="",r.emit("mus-info"),e.createRoom=function(){t.openConfirm({template:"./src/views/ngDialogTemplates/createRoomDialog.html",className:"ngdialog-theme-default",preCloseCallback:function(){var e=t.openConfirm({template:"./src/views/ngDialogTemplates/nameMissingConfirmationDialog.html",className:"ngdialog-theme-default"});return e},scope:e}).then(function(o){e.playerName=o,"undefined"!=typeof e.playerName&&""!==e.playerName&&r.emit("create-room",e.playerName)})},e.$on("socket:room-creation-success",function(e,t){o.url("/room/"+t)}),e.$on("socket:update-mus",function(o,t){e.updateModel(JSON.parse(t))}),e.updateModel=function(o){e.musModel=o},e.joinRoom=function(e){o.url("/room/"+e)}}])}(),function(){"use strict";angular.module("musApp").controller("roomCtrl",["$scope","$location","$routeParams","ngDialog","musSocketService",function(e,o,t,r,a){e.playerName="",e.room={},a.emit("room-info",t.roomId),e.$on("socket:room-info-success",function(t,n){e.updateRoom(JSON.parse(n).room),e.playerName=JSON.parse(n).playerName,e.isRoomFull()?(r.open({template:"./src/views/ngDialogTemplates/roomFullDialog.html",data:{roomId:e.room.id},className:"ngdialog-theme-default"}),o.url("/")):e.isUserInRoomAlready()||r.openConfirm({template:"./src/views/ngDialogTemplates/joinRoomDialog.html",className:"ngdialog-theme-default",preCloseCallback:function(){var e=r.openConfirm({template:"./src/views/ngDialogTemplates/nameMissingConfirmationDialog.html",className:"ngdialog-theme-default"});return e},scope:e}).then(function(t){e.playerName=t,"undefined"!=typeof e.playerName&&""!==e.playerName?a.emit("join-room",e.playerName,e.room.id):(r.open({template:"./src/views/ngDialogTemplates/noValidNameDialog.html",className:"ngdialog-theme-default"}),o.url("/"))},function(){o.url("/")})}),e.$on("socket:room-info-failure",function(e,t){r.open({template:"./src/views/ngDialogTemplates/noValidRoomDialog.html",data:{roomId:t},className:"ngdialog-theme-default"}),o.url("/")}),e.$on("socket:room-join-failure",function(){r.open({template:"./src/views/ngDialogTemplates/joinRoomFailureDialog.html",className:"ngdialog-theme-default"}),o.url("/")}),e.$on("socket:leave-room-success",function(){o.url("/")}),e.$on("socket:update-room",function(o,t){e.$apply(function(){e.updateRoom(JSON.parse(t))})}),e.updateRoom=function(o){e.room=o},e.isRoomFull=function(){return e.room.maxPlayers===e.room.players.length},e.isUserInRoomAlready=function(){return e.room.players.indexOf(e.playerName)>-1},e.leaveRoom=function(){a.emit("leave-room",e.room.id)}}])}(),function(){"use strict";angular.module("musApp").filter("formatMessage",function(){return function(e,o){return(new Date).toLocaleTimeString()+" - "+e+": "+o+"\n"}})}(),function(){"use strict";angular.module("musApp").filter("getKeys",function(){return function(e,o){for(var t in o)e.push(t);return e}})}(),function(){"use strict";angular.module("musApp").directive("chat",function(){return{restrict:"E",replace:!0,templateUrl:"src/views/templates/chat.html",controller:"chatController"}})}(),function(){"use strict";angular.module("musApp").directive("game",function(){return{restrict:"E",replace:!0,templateUrl:"src/views/templates/game.html"}})}(),function(){"use strict";angular.module("musApp").config(["$routeProvider",function(e){e.when("/",{templateUrl:"src/views/main.html",controller:"mainCtrl"}).when("/room/:roomId",{templateUrl:"src/views/room.html",controller:"roomCtrl"}).otherwise({redirectTo:"/"})}])}(),function(){"use strict";angular.module("musApp").factory("musSocketService",function(e){var o=e();return o.forward("update-mus"),o.forward("update-room"),o.forward("room-creation-success"),o.forward("room-info-success"),o.forward("room-info-failure"),o.forward("room-join-failure"),o.forward("room-join-success"),o.forward("new-player-joined"),o.forward("leave-room-success"),o.forward("player-left"),o.forward("new-message"),o})}();